\begin{frame}
  \begin{center}
    \LARGE <<Глиноведение>>
  \end{center}

  \begin{itemize}
  \item Идея задачи --- Кто-то
  \item Разработка задачи --- Максим Деб Натх
  \end{itemize}

\end{frame}

\begin{frame}{Постановка задачи}

  \begin{itemize}
  \item Дана скобочная последовательность
  \item За $l$ времени можно перемешать любой её подотрезок длины $l$
  \item Нужно за минимальное время сделать последовательность правильной скобочной
  \end{itemize}
  
\end{frame}

\begin{frame}{Ответ отрицательный}
  \begin{itemize}
  \item Поймём, когда мы не можем сделать последовательность ПСП
  \item Тогда и только тогда, когда число \texttt{<<(>>} и число \texttt{<<(>>} в строке отличается
  \item Иначе всегда можно взять всю строку и переставить в ней за $n$ символы так, чтобы строка стала ПСП, например, \texttt{<<(((($\dots$))))>>}
  \end{itemize}
\end{frame}

\begin{frame}{Решение за $\mathcal{O}(n^2)$ (50 баллов)}
  \begin{itemize}
  \item Скобочный баланс -- разность между количеством \texttt{<<(>>} и количеством \texttt{<<)>>}
  \item За $bal_i$ ($i:\,0\dots n$) обозначим скобочный баланс на первых $i$ символах
  \end{itemize}
\end{frame}

\begin{frame}{Решение за $\mathcal{O}(n^2)$ (50 баллов)}
  \begin{itemize}
  \item В оптимальном решении отрезки, на которых производятся перемешивания не пересекаются
  \item Зафиксируем $i$-ю позицию и возьмём все отезки, которые пересекаются с ней, затем возьмём все отрезки, которые пересекаются с ними и так далее

  \end{itemize}
\end{frame}



\begin{frame}{Решение за $\mathcal{O}(n^2)$ (50 баллов)}
  \begin{itemize}

  \item Получим набор отрезков $a_1,\dots,a_k$, в объединении дающие отрезок $b$
  \item Вместо выполнения перемешиваний на отрезках $a_1,\dots,a_k$, перемешаем скобки на отрезке $b$ один раз~--- на это уйдёт не больше времени
  \end{itemize}
\end{frame}

\begin{frame}{Решение за $\mathcal{O}(n^2)$ (50 баллов)}
  \begin{itemize}
  \item Используем динамику $dp_i=$ сколько времени нужно, чтобы сделать префикс из $i$ символов префиксом ПСП
  \item $dp_i = -\infty$, если $bal_i < 0$, иначе

  \[ dp_i = \min \left\{
\begin{array}{ll}
dp_{i-1} & \textrm{если } bal_i \geq 0 \textrm{ и } bal_{i-1} \geq 0 \\
j + dp_{i-j} & \textrm{по всем } j \leq i \textrm{ таким, что } \\
& bal_i \leq bal_{i-j}
\end{array} \right. \]
  \item Начальное значение: $dp_0 = 0$. 
  \end{itemize}
\end{frame}

\begin{frame}{Полное решение за $\mathcal{O}(n)$}
  \begin{itemize}
  \item Рассмотрим такой индекс $i$, что что $bal_{i-1} \leq 0$, $bal_{i} < 0$, либо $bal_{i-1} < 0$, $bal_i \leq 0$. Тогда, если символ $s_i$ не будет участвовать ни в одном перемешивании, то итоговая строка будет иметь $i$-й или $i-1$-й префиксный баланс отрицательным
  \item Изобразим данную с.п. как ломанную. Описанные выше индексы~--- это все отрезки ниже линии $x=0$
  \end{itemize}
\end{frame} 

\begin{frame}{Полное решение за $\mathcal{O}(n)$}
\begin{figure}[htb]
    \centering
    \resizebox{0.6\textwidth}{!}{
\begin{tikzpicture}
    \draw [red, thick] (0,0) -- ++(1,-1) -- ++(1, 1);
    \draw [thick] (2,0) -- ++(1,1) -- ++(1,-1);
    \draw [red, thick] (4,0) -- ++(1,-1) -- ++(1, -1) -- ++(1, 1) -- ++(1, -1) -- ++(1, 1) -- ++(1, 1);
    \draw [thick] (-2,0) -- ++(1,1) -- ++(1,-1);
\end{tikzpicture}}%
    \caption{ПСП до перемешиваний}
  \end{figure}
  Видно, что если взять все последовательности красных скобок и развернуть их, получим ПСП:
  \begin{figure}[htb]
    \centering
    \resizebox{0.6\textwidth}{!}{
\begin{tikzpicture}
    \draw [blue, thick] (0,0) -- ++(1,1) -- ++(1, -1);
    \draw [thick] (2,0) -- ++(1,1) -- ++(1,-1);
    \draw [blue, thick] (4,0) -- ++(1,1) -- ++(1, 1) -- ++(1, -1) -- ++(1, 1) -- ++(1, -1) -- ++(1, -1);
    \draw [thick] (-2,0) -- ++(1,1) -- ++(1,-1);
\end{tikzpicture}}%
    \caption{ПСП после перемешиваний}
  \end{figure}


\end{frame} 

\begin{frame}{Полное решение за $\mathcal{O}(n)$}
  \begin{itemize}
  \item Значит, достаточно найти просто количество таких индексов $i$,  ~--- это число и будет ответом.
  \end{itemize}
\end{frame} 
\begin{frame}
  \begin{center}
    \LARGE <<Реалити-шоу>>
  \end{center}

  \begin{center}
      \includegraphics[width=5cm]{memes/g-meme.jpg}
  \end{center}

  \begin{itemize}
  \item Идея задачи --- Романов Владимир, ВШЭ
  \item Разработка задачи --- Погодин Михаил, ВШЭ
  \end{itemize}

\end{frame}

\begin{frame}{Постановка задачи}
  \begin{itemize}
    \vspace{-1em}
  \item Даны $n$ значений $v_i \leq m$, $n$ значений $s_i$ и $n + m$ значений $c_i$
  \item Требуется выбрать подмножество индексов $1 \leq i_1 < i_2 < \ldots < i_k \leq n, v_{i_1} \geq v_{i_2} \geq \ldots v_{i_k}$ с максимальной стоимостью
  \item При добавлении в множество элемента со значением $v$ в стоимость множества добавляется $c_v$ и если в множестве два элемента со значением $v$, то они оба удаляются и добавляется $v + 1$ (с увеличением стоимости множества на $c_{v+1}$).
  \item Для получения итоговой стоимости нужно вычесть $s_{i_1} + s_{i_2} + \ldots + s_{i_k}$
  \end{itemize}
\end{frame}

\begin{frame}{Решение за $\O(2^n n^2)$ (14 баллов)}
  \begin{itemize}
  \item Переберем за $\O(2^n)$ подмножество элементов.
  \item Далее за $\O(n^2)$ можно просимулировать процесс и найти прибыль.
  \end{itemize}
\end{frame}

\begin{frame}{Решение за $\O(n^2)$ для $m = 1$ (24~балла)}
  \begin{itemize}
  \item В данной группе нужно заметить, что всегда лучше брать людей, которые требуют меньшую зарплату.
  \item Отсортируем работников по возрастанию зарплаты.
  \item Переберем число людей, которых мы возьмем и честно просимулируем.
  \end{itemize}
\end{frame}

\begin{frame}{Ключевая идея}
  \begin{itemize}
  \item Перефразируем происходящее:
  \item Представим все элементы как степени двойки.
  \item Будем хранить сумму взятых элементов.
  \item Мы платим за взятие элемента, прибавляем его к текущему числу и получаем прибыль за каждый перенос.
  \end{itemize}
\end{frame}

\begin{frame}{Решение за $\O(n^22^mm)$ (34 баллов)}
  \begin{itemize}
  \item Сумма взятых элементов не больше, чем $n2^m$.
  \item Тогда можно применить метод динамического программирования и
  решить задачу за $\O((n 2^m) \cdot n m)$.
  \end{itemize}
\end{frame}

\begin{frame}{Решение за $\O(n^2m)$ (75 баллов)}
  \begin{itemize}
  \item Рассмотрим сумму и минимальное число, которое мы взяли.
  \item Заметим, что если брать только элементы с таким же значением, то только $\O(\log(n))$ бит суммы могут изменится как угодно, правда ещё возможно происходит один перенос вне этих битов.
  \item Снова применим метод динамического программирования и попытаемся учесть предыдущее наблюдение.
  \end{itemize}
\end{frame}

\begin{frame}{Решение за $\O(n^2m)$ (75 баллов)}
  \begin{itemize}
  \item Пусть мы просмотрели префикс массива, тогда:
  \item $dp[value][carry][mask] = \text{max profit}$, где:\\
  \indent $value$ --- можно брать только элементы $\le \t{value}$ \\
  \indent $carry$ --- происходит ли перенос \\
  \indent $mask$ --- последние $\log(n)$ бит \\
  \item Переходы: взять элемент, пересчитать $dp[value + 1]$ через $dp[value]$.
  \item Итогo мы $n$ раз пересчитаем динамику размером $\O(nm)$
  \end{itemize}
\end{frame}

\begin{frame}{Более простое решение за $\O(n^2m)$ (75 баллов)}
  \begin{itemize}
  \item Попробуем набирать элементы в ответ справа налево. Тогда состояние процесса:
  \item $\langle index, curvalue, cntvalue \rangle$, уже прошли до \t{index},
    текущее рассматриваемое значение \t{curvalue} и их таких \t{cntvalue}.
  \item Тогда перехода всего два: сдвинуть \t{index} и возможно взять элемент,
  \item или укрупнить элементы: $(value, cnt) \to (value + 1, cnt / 2)$.
  \item Формально, поддерживаем $dp[curvalue][cntvalue]$ и обновляем её новыми элементами.
  \end{itemize}
\end{frame}

\begin{frame}{Полное решение $\O(n(n + m))$}
  \begin{itemize}
  \item Осталось заметить, что динамика меньше, чем кажется.
  \item Если у нас есть элемент со значением $x$, то при $value=x$ он вкладывается в
    кратность как $1$, при $value = x+1$ как $0.5$, и так далее.
  \item Сделаем \t{dp} неравномерного размера, оценим для каждого \t{value} максимальное \t{cntvalue} из соображений выше.
  \item Сумма таких $\t{max cntvalue}$ равна $\O(n + m)$, т.к. можно свернуть геометрическую прогрессию.
  \end{itemize}
\end{frame}
